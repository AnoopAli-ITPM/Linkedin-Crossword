<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>IT PM Crossword Challenge</title>
<style>
:root{--bg:#f7fbff;--accent:#9b72aa;--accent2:#6dd3ce;--dark:#122;--muted:#666;}
body{font-family:Inter,Arial,Helvetica,sans-serif;background:linear-gradient(135deg,var(--accent2),#fff);margin:0;padding:20px;color:var(--dark);}
.container{max-width:1100px;margin:0 auto;background:#fff;padding:18px;border-radius:10px;box-shadow:0 8px 24px rgba(0,0,0,0.08);}
.header{display:flex;align-items:center;gap:12px;}
.logo{width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;}
.title{font-size:20px;margin:0;}
.controls{display:flex;gap:8px;margin-top:12px;align-items:center;}
.input{padding:8px;border-radius:6px;border:1px solid #ddd;font-size:14px;}
.start-btn{background:var(--accent);color:#fff;border:0;padding:9px 12px;border-radius:8px;cursor:pointer;font-weight:700;}
.grid-area{display:flex;gap:18px;margin-top:18px;flex-wrap:wrap;}
.grid-wrap{background:#fff;padding:10px;border:4px solid #000;border-radius:6px;}
table.cross{border-collapse:collapse;}
table.cross td{width:34px;height:34px;border:1px solid #000;position:relative;background:#fff;}
table.cross td.block{background:#000;border:1px solid #000;}
input.cell{width:100%;height:100%;border:0;text-align:center;font-weight:700;font-size:15px;text-transform:uppercase;background:transparent;caret-color:var(--accent);}
.clue-number{position:absolute;top:1px;left:2px;font-size:10px;color:#000;}
.panel{background:linear-gradient(180deg,#fff,#f8f8ff);padding:12px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);min-width:240px;}
.score{font-size:34px;font-weight:800;color:var(--accent);}
.small{font-size:13px;color:var(--muted);}
.btn{padding:8px 10px;border-radius:6px;border:0;cursor:pointer;font-weight:700;}
.quit-btn{background:#eee;}
.post-btn{background:var(--accent2);color:#003;border:0;padding:10px;border-radius:8px;cursor:pointer;font-weight:800;}
.comments{margin-top:12px;max-height:260px;overflow:auto;padding:8px;border-radius:6px;border:1px dashed #ddd;background:#fff;}
.comment{padding:8px;border-bottom:1px solid #f1f1f1;font-size:14px;}
.footer{font-size:12px;color:#666;margin-top:12px;}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div class="logo">PM</div>
    <div>
      <div class="title">IT Project Manager â€” Crossword Challenge</div>
      <div class="small">Enter your details, start the 30-minute timer and solve the puzzle. Share your score to LinkedIn.</div>
    </div>
  </div>

  <div class="controls">
    <input id="playerName" class="input" placeholder="Your name (required)">
    <input id="playerDesig" class="input" placeholder="Designation (required)">
    <button id="startBtn" class="start-btn">Start Puzzle</button>
    <div style="margin-left:auto;" class="small">Timer: <span id="timer">30:00</span></div>
  </div>

  <div class="grid-area">
    <div class="grid-wrap" id="gridWrap" aria-live="polite"></div>
    <div class="panel">
      <div><strong>Live Score</strong></div>
      <div class="score" id="liveScore">0</div>
      <div class="small" id="wordProgress">Words found: 0 / 10</div>
      <div style="margin-top:10px;"><strong>Hints</strong></div>
      <ul id="hintsList" class="small"></ul>
      <div style="margin-top:12px;display:flex;gap:8px;">
        <button id="quitBtn" class="btn quit-btn">Quit & Submit</button>
        <button id="showBtn" class="btn">Show Solutions</button>
      </div>
      <div style="margin-top:12px;">
        <input id="postUrl" class="input" placeholder="(optional) LinkedIn post URL to open when posting">
        <div class="small">Leave blank to open LinkedIn feed.</div>
      </div>
      <div style="margin-top:12px;">
        <button id="postLinkedIn" class="post-btn">Post to LinkedIn</button>
        <button id="copyComment" class="btn">Copy Comment</button>
      </div>
    </div>
  </div>

  <div style="margin-top:16px;" class="panel">
    <div style="display:flex;justify-content:space-between;align-items:center;"><strong>Recent Submissions</strong><span class="small">Local leaderboard</span></div>
    <div id="submissions" class="comments"><div style="padding:12px;color:#666">No submissions yet.</div></div>
  </div>

  <div class="footer">Note: The app prepares the comment and opens LinkedIn â€” you must paste and post manually on LinkedIn (required by LinkedIn).</div>
</div>

<script>
/* Words and hints */
const WORDS = {
  "AGILE":"An iterative approach to software delivery.",
  "SCRUM":"A popular Agile framework.",
  "SDLC":"A software development lifecycle.",
  "STAKEHOLDER":"Someone affected by project outcomes.",
  "RISK":"Potential negative event.",
  "BUDGET":"Financial allocation.",
  "TIMELINE":"Project schedule.",
  "SCOPE":"Project boundaries.",
  "RAID":"Risks, Assumptions, Issues, Dependencies.",
  "JIRA":"PM/issue tracking tool."
};
const WORD_LIST = Object.keys(WORDS);
const GRID_SIZE = 15;
let placements = [];
let gridSolutions = [];
let gameRunning=false;
let timeLeft=1800;
let timerInterval=null;

/* Utilities */
function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } return a; }
function randomLetter(){ return String.fromCharCode(65+Math.floor(Math.random()*26)); }

/* Place words with simple algorithm */
function placeWords(){
  const grid = Array.from({length:GRID_SIZE},()=>Array(GRID_SIZE).fill(null));
  placements=[];
  const dirs=[[0,1],[1,0]];
  const words=WORD_LIST.slice().sort((a,b)=>b.length-a.length);
  for(let w of words){
    let placed=false;
    let spots=[];
    for(let r=0;r<GRID_SIZE;r++) for(let c=0;c<GRID_SIZE;c++) for(let d=0;d<dirs.length;d++) spots.push([r,c,dirs[d][0],dirs[d][1]]);
    shuffle(spots);
    for(let [r,c,dr,dc] of spots){
      if(canPlace(w,r,c,dr,dc,grid)){
        for(let i=0;i<w.length;i++) grid[r+dr*i][c+dc*i]=w[i];
        placements.push({word:w,r,c,dr,dc});
        placed=true; break;
      }
    }
    if(!placed) return placeWords();
  }
  for(let r=0;r<GRID_SIZE;r++) for(let c=0;c<GRID_SIZE;c++) if(!grid[r][c]) grid[r][c]=randomLetter();
  return grid;
}

function canPlace(word,r,c,dr,dc,grid){
  for(let i=0;i<word.length;i++){
    const rr=r+dr*i, cc=c+dc*i;
    if(rr<0||rr>=GRID_SIZE||cc<0||cc>=GRID_SIZE) return false;
    if(grid[rr][cc] && grid[rr][cc]!==word[i]) return false;
  }
  return true;
}

/* Build UI */
function numberPlacements(){ let n=1; placements.forEach(p=>p.num=n++); }
function buildHints(){ const ul=document.getElementById('hintsList'); ul.innerHTML=''; const sorted=placements.slice().sort((a,b)=>a.num-b.num); sorted.forEach(p=>{ const li=document.createElement('li'); li.textContent = `${p.num} ${p.dr===0?'Across':'Down'}: ${WORDS[p.word]}`; ul.appendChild(li); }); }
function buildGrid(){
  const gridWrap=document.getElementById('gridWrap');
  gridWrap.innerHTML='';
  const table=document.createElement('table'); table.className='cross';
  for(let r=0;r<GRID_SIZE;r++){
    const tr=document.createElement('tr');
    for(let c=0;c<GRID_SIZE;c++){
      const td=document.createElement('td');
      let isPart=false, startNum=null;
      for(let p of placements){
        for(let i=0;i<p.word.length;i++){
          if(p.r+i*p.dr===r && p.c+i*p.dc===c){ isPart=true; if(i===0) startNum=p.num; break; }
        }
      }
      if(!isPart){ td.className='block'; tr.appendChild(td); continue; }
      if(startNum){ const d=document.createElement('div'); d.className='clue-number'; d.textContent=startNum; td.appendChild(d); }
      const inp=document.createElement('input'); inp.className='cell'; inp.maxLength=1; inp.dataset.solution = gridSolutions[r][c]; inp.addEventListener('input', onCellInput); td.appendChild(inp); tr.appendChild(td);
    }
    table.appendChild(tr);
  }
  gridWrap.appendChild(table);
}

/* Game mechanics */
function onCellInput(e){ e.target.value = e.target.value.toUpperCase().replace(/[^A-Z]/g,''); updateLiveScore(); checkCompletion(); }
function updateLiveScore(){
  const inputs = document.querySelectorAll('input.cell');
  let correct=0;
  inputs.forEach(i=>{ if(i.value && i.value.toUpperCase()===i.dataset.solution.toUpperCase()) correct++; });
  document.getElementById('liveScore').textContent = correct;
  let found=0;
  for(let p of placements){
    let ok=true;
    for(let i=0;i<p.word.length;i++){
      const cell = getCellAt(p.r + i*p.dr, p.c + i*p.dc);
      if(!cell || cell.value.toUpperCase()!==p.word[i]){ ok=false; break; }
    }
    if(ok) found++;
  }
  document.getElementById('wordProgress').textContent = `Words found: ${found} / ${placements.length}`;
}

function getCellAt(r,c){
  const tbl = document.querySelector('table.cross');
  if(!tbl) return null;
  const row = tbl.rows[r];
  if(!row) return null;
  const cell = row.cells[c];
  if(!cell) return null;
  return cell.querySelector('input.cell');
}

function checkCompletion(){
  let all=true;
  for(let p of placements){
    for(let i=0;i<p.word.length;i++){
      const cell = getCellAt(p.r + i*p.dr, p.c + i*p.dc);
      if(!cell || cell.value.toUpperCase()!==p.word[i]){ all=false; break; }
    }
    if(!all) break;
  }
  if(all && gameRunning){ finish('completed'); }
}

/* Timer */
function formatTime(sec){ const m=Math.floor(sec/60); const s=sec%60; return `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`; }
function startTimer(){ document.getElementById('timer').textContent = formatTime(timeLeft); timerInterval = setInterval(()=>{ timeLeft--; document.getElementById('timer').textContent = formatTime(timeLeft); if(timeLeft<=0){ clearInterval(timerInterval); finish('timeout'); } },1000); }
function stopTimer(){ clearInterval(timerInterval); }

/* Start/finish */
document.getElementById('startBtn').addEventListener('click', ()=>{
  const name=document.getElementById('playerName').value.trim();
  const des=document.getElementById('playerDesig').value.trim();
  if(!name||!des){ alert('Please enter name and designation'); return; }
  gridSolutions = placeWords(); numberPlacements(); buildGrid(); buildHints(); updateLiveScore();
  timeLeft=1800; gameRunning=true; stopTimer(); startTimer();
  document.getElementById('playerName').disabled=true; document.getElementById('playerDesig').disabled=true; document.getElementById('startBtn').disabled=true;
});

document.getElementById('quitBtn').addEventListener('click', ()=>{
  if(!gameRunning){ alert('Game not running'); return; }
  if(confirm('Quit and submit your current progress?')) finish('quit');
});

document.getElementById('showBtn').addEventListener('click', ()=>{
  document.querySelectorAll('input.cell').forEach(i=> i.value = i.dataset.solution);
  updateLiveScore();
  checkCompletion();
});

/* Finish game and save submission */
function finish(status){
  gameRunning=false; stopTimer();
  const score = parseInt(document.getElementById('liveScore').textContent || '0',10);
  const elapsed = 1800 - timeLeft;
  const minutes = Math.floor(elapsed/60); const seconds = elapsed%60;
  const rec = { name: document.getElementById('playerName').value.trim(), desig: document.getElementById('playerDesig').value.trim(), score, minutes, seconds, status, timestamp: new Date().toISOString() };
  saveSubmission(rec); renderSubmissions();
  window.finalComment = `Interesting! I just completed the IT Project Manager Crossword Challenge! ðŸ§©
I scored ${score} in ${minutes} minutes ${seconds} seconds!`;
  alert(`Finished: ${status.toUpperCase()}\nScore: ${score}\nTime: ${minutes}m ${seconds}s\nComment prepared for LinkedIn.`);
  document.getElementById('playerName').disabled=false; document.getElementById('playerDesig').disabled=false; document.getElementById('startBtn').disabled=false;
}

/* Local storage leaderboard */
function loadSubmissions(){ try{ return JSON.parse(localStorage.getItem('pm_crossword_subs')||'[]'); }catch(e){ return []; } }
function saveSubmission(rec){ const arr = loadSubmissions(); arr.unshift(rec); localStorage.setItem('pm_crossword_subs', JSON.stringify(arr.slice(0,200))); }
function renderSubmissions(){ const box=document.getElementById('submissions'); const subs = loadSubmissions(); box.innerHTML=''; if(subs.length===0){ box.innerHTML='<div style="padding:12px;color:#666">No submissions yet.</div>'; return; } subs.slice(0,50).forEach(s=>{ const d=document.createElement('div'); d.className='comment'; d.innerHTML = `<strong>${escapeHtml(s.name)}</strong> â€” ${escapeHtml(s.desig)}<br/><small>${s.minutes}m ${s.seconds}s â€¢ ${s.status} â€¢ Score: ${s.score}</small>`; box.appendChild(d); }); }
function escapeHtml(t){ return t.replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); }
renderSubmissions();

/* LinkedIn post handling */
const cleanLinkedIn = "https://www.linkedin.com/posts/anoopali-certified-itprojectmanager_pm-activity-7405268278832590848-igYx";
document.getElementById("postLinkedIn").addEventListener("click", ()=>{

    if(!window.finalComment){
        alert("Complete or submit the puzzle first to prepare a comment.");
        return;
    }

    // Copy prepared comment
    navigator.clipboard.writeText(window.finalComment)
    .then(()=>{

        // Your EXACT LinkedIn post URL (fully preserved)
        const linkedinPostURL = 
"https://www.linkedin.com/posts/anoopali-certified-itprojectmanager_pm-activity-7405268278832590848-igYx?utm_source=share&utm_medium=member_desktop&rcm=ACoAAAvUOIkB9LVWwJkCTj9YzqPi8XkMXJ3_YZw";

        // Open your post directly
        window.open(linkedinPostURL, "_blank");

        alert("Comment copied! Paste it into your LinkedIn post and press POST.");
    })
    .catch(()=>{
        alert("Copied failed â€” here is your comment:\n\n" + window.finalComment);
    });
});

document.getElementById('copyComment').addEventListener('click', ()=>{
  if(!window.finalComment){ alert('No prepared comment yet.'); return; }
  navigator.clipboard.writeText(window.finalComment).then(()=>alert('Comment copied to clipboard.')).catch(()=>alert('Copy failed. Here is the text:\n\n'+window.finalComment));
});
</script>
</body>
</html>
